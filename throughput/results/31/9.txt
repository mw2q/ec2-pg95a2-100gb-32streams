BEGIN;
BEGIN
select
	nation,
	o_year,
	sum(amount) as sum_profit
from
	(
		select
			n_name as nation,
			extract(year from o_orderdate) as o_year,
			l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount
		from
			part,
			supplier,
			lineitem,
			partsupp,
			orders,
			nation
		where
			s_suppkey = l_suppkey
			and ps_suppkey = l_suppkey
			and ps_partkey = l_partkey
			and p_partkey = l_partkey
			and o_orderkey = l_orderkey
			and s_nationkey = n_nationkey
			and p_name like '%beige%'
	) as profit
group by
	nation,
	o_year
order by
	nation,
	o_year desc;
          nation           | o_year |    sum_profit    
---------------------------+--------+------------------
 ALGERIA                   |   1998 | 2724254283.35375
 ALGERIA                   |   1997 |  4664630180.3225
 ALGERIA                   |   1996 | 4639667827.81651
 ALGERIA                   |   1995 | 4655430740.76458
 ALGERIA                   |   1994 | 4621885029.61526
 ALGERIA                   |   1993 | 4636686255.51499
 ALGERIA                   |   1992 | 4677424563.31095
 ARGENTINA                 |   1998 | 2707117155.73883
 ARGENTINA                 |   1997 | 4659137528.41142
 ARGENTINA                 |   1996 | 4643489607.99494
 ARGENTINA                 |   1995 | 4629597849.61846
 ARGENTINA                 |   1994 | 4631241341.85431
 ARGENTINA                 |   1993 |  4635719443.4419
 ARGENTINA                 |   1992 | 4662926380.29075
 BRAZIL                    |   1998 | 2745228724.57242
 BRAZIL                    |   1997 | 4675964409.49703
 BRAZIL                    |   1996 | 4713286686.04438
 BRAZIL                    |   1995 | 4674825750.48859
 BRAZIL                    |   1994 | 4655348944.38654
 BRAZIL                    |   1993 | 4660170658.68457
 BRAZIL                    |   1992 | 4704368353.33639
 CANADA                    |   1998 | 2740780681.47849
 CANADA                    |   1997 | 4699872319.89986
 CANADA                    |   1996 | 4693932511.68849
 CANADA                    |   1995 | 4688396266.42496
 CANADA                    |   1994 | 4709218985.15633
 CANADA                    |   1993 | 4679159691.35961
 CANADA                    |   1992 | 4698669991.96531
 CHINA                     |   1998 | 2721575001.46585
 CHINA                     |   1997 | 4650708855.72122
 CHINA                     |   1996 | 4674945612.92295
 CHINA                     |   1995 | 4662262736.09282
 CHINA                     |   1994 | 4674546605.90609
 CHINA                     |   1993 | 4666737392.74847
 CHINA                     |   1992 | 4673655523.25767
 EGYPT                     |   1998 | 2743043022.07614
 EGYPT                     |   1997 |  4646502345.2138
 EGYPT                     |   1996 | 4701282861.83412
 EGYPT                     |   1995 | 4635185247.74844
 EGYPT                     |   1994 | 4670792063.27185
 EGYPT                     |   1993 | 4657024099.72656
 EGYPT                     |   1992 | 4658934784.11976
 ETHIOPIA                  |   1998 | 2758244629.80826
 ETHIOPIA                  |   1997 | 4672940705.93976
 ETHIOPIA                  |   1996 | 4684492470.98883
 ETHIOPIA                  |   1995 | 4685039374.25207
 ETHIOPIA                  |   1994 | 4669360275.89723
 ETHIOPIA                  |   1993 | 4664904798.91489
 ETHIOPIA                  |   1992 | 4692241257.70793
 FRANCE                    |   1998 | 2713401070.21209
 FRANCE                    |   1997 | 4656881110.74676
 FRANCE                    |   1996 | 4682820068.52046
 FRANCE                    |   1995 | 4666328974.79933
 FRANCE                    |   1994 | 4655929799.28567
 FRANCE                    |   1993 | 4658487364.67588
 FRANCE                    |   1992 | 4671983339.45927
 GERMANY                   |   1998 | 2736358068.98108
 GERMANY                   |   1997 | 4651910638.34753
 GERMANY                   |   1996 | 4666939614.62722
 GERMANY                   |   1995 | 4640682617.05121
 GERMANY                   |   1994 | 4663355277.99969
 GERMANY                   |   1993 | 4692891611.98007
 GERMANY                   |   1992 | 4683431932.60806
 INDIA                     |   1998 |  2733881143.5635
 INDIA                     |   1997 | 4659649152.71004
 INDIA                     |   1996 | 4688974124.27147
 INDIA                     |   1995 | 4660088197.51711
 INDIA                     |   1994 | 4671653327.58841
 INDIA                     |   1993 | 4672975374.03739
 INDIA                     |   1992 | 4682808052.75897
 INDONESIA                 |   1998 | 2710397102.03075
 INDONESIA                 |   1997 | 4630527019.92587
 INDONESIA                 |   1996 | 4642259541.45158
 INDONESIA                 |   1995 | 4610729222.40158
 INDONESIA                 |   1994 | 4645571229.34144
 INDONESIA                 |   1993 | 4654576179.52134
 INDONESIA                 |   1992 | 4638426693.64275
 IRAN                      |   1998 | 2719298515.96609
 IRAN                      |   1997 | 4620438398.17032
 IRAN                      |   1996 | 4628539866.20823
 IRAN                      |   1995 | 4605044754.13461
 IRAN                      |   1994 | 4623179177.99409
 IRAN                      |   1993 | 4597666946.64274
 IRAN                      |   1992 | 4629647958.48014
 IRAQ                      |   1998 | 2713692518.95383
 IRAQ                      |   1997 | 4639268481.49234
 IRAQ                      |   1996 | 4644631591.94718
 IRAQ                      |   1995 | 4650083959.69861
 IRAQ                      |   1994 | 4663498743.45374
 IRAQ                      |   1993 | 4620858659.83896
 IRAQ                      |   1992 | 4661442873.22876
 JAPAN                     |   1998 |  2708709711.5474
 JAPAN                     |   1997 | 4621809613.89281
 JAPAN                     |   1996 | 4638381824.37767
 JAPAN                     |   1995 | 4620577777.59299
 JAPAN                     |   1994 | 4628893400.19838
 JAPAN                     |   1993 | 4614912932.02208
 JAPAN                     |   1992 | 4610198758.14322
 JORDAN                    |   1998 |  2700560773.8302
 JORDAN                    |   1997 | 4633363289.61877
 JORDAN                    |   1996 | 4645145590.06716
 JORDAN                    |   1995 | 4624780755.27733
 JORDAN                    |   1994 | 4664624328.90185
 JORDAN                    |   1993 | 4636262569.34113
 JORDAN                    |   1992 | 4639527713.02104
 KENYA                     |   1998 | 2702313541.62223
 KENYA                     |   1997 |  4617613979.4242
 KENYA                     |   1996 | 4635492393.03602
 KENYA                     |   1995 | 4614696327.35038
 KENYA                     |   1994 | 4586406627.97672
 KENYA                     |   1993 | 4621411333.15228
 KENYA                     |   1992 | 4624886009.90884
 MOROCCO                   |   1998 | 2724049734.48295
 MOROCCO                   |   1997 | 4696554207.77507
 MOROCCO                   |   1996 | 4706888554.75093
 MOROCCO                   |   1995 | 4661807075.43836
 MOROCCO                   |   1994 | 4680232422.45359
 MOROCCO                   |   1993 | 4695506366.32801
 MOROCCO                   |   1992 | 4673289869.95537
 MOZAMBIQUE                |   1998 | 2699599583.37377
 MOZAMBIQUE                |   1997 | 4637395064.59775
 MOZAMBIQUE                |   1996 | 4667525678.07764
 MOZAMBIQUE                |   1995 |  4654257033.8124
 MOZAMBIQUE                |   1994 | 4647433058.76079
 MOZAMBIQUE                |   1993 | 4669153295.95035
 MOZAMBIQUE                |   1992 | 4667185811.04561
 PERU                      |   1998 | 2712989275.42406
 PERU                      |   1997 | 4642385091.71841
 PERU                      |   1996 | 4627284231.66597
 PERU                      |   1995 | 4664751508.53044
 PERU                      |   1994 | 4639455012.96864
 PERU                      |   1993 |  4637589762.3045
 PERU                      |   1992 | 4669235961.71286
 ROMANIA                   |   1998 | 2750757554.52287
 ROMANIA                   |   1997 | 4691311538.43307
 ROMANIA                   |   1996 |  4670360036.1042
 ROMANIA                   |   1995 |  4674363714.6188
 ROMANIA                   |   1994 | 4659680773.63509
 ROMANIA                   |   1993 | 4658856916.28074
 ROMANIA                   |   1992 | 4673614176.32565
 RUSSIA                    |   1998 | 2735772009.01821
 RUSSIA                    |   1997 | 4647576821.32314
 RUSSIA                    |   1996 | 4630945685.50247
 RUSSIA                    |   1995 | 4643424475.28733
 RUSSIA                    |   1994 | 4643820315.48969
 RUSSIA                    |   1993 | 4659102263.41666
 RUSSIA                    |   1992 | 4667866341.13811
 SAUDI ARABIA              |   1998 | 2739103234.81164
 SAUDI ARABIA              |   1997 | 4660285684.50657
 SAUDI ARABIA              |   1996 | 4663275067.96925
 SAUDI ARABIA              |   1995 | 4664794934.92608
 SAUDI ARABIA              |   1994 | 4663602620.19655
 SAUDI ARABIA              |   1993 | 4654460553.23074
 SAUDI ARABIA              |   1992 | 4658123485.81195
 UNITED KINGDOM            |   1998 |  2751849087.5096
 UNITED KINGDOM            |   1997 | 4721863702.51141
 UNITED KINGDOM            |   1996 | 4712985923.89412
 UNITED KINGDOM            |   1995 | 4693539037.91117
 UNITED KINGDOM            |   1994 | 4701865293.66165
 UNITED KINGDOM            |   1993 | 4696248165.85749
 UNITED KINGDOM            |   1992 | 4699715936.59365
 UNITED STATES             |   1998 |  2746141468.4234
 UNITED STATES             |   1997 | 4659861511.49058
 UNITED STATES             |   1996 | 4689901714.70607
 UNITED STATES             |   1995 | 4668053046.50334
 UNITED STATES             |   1994 | 4675512895.61998
 UNITED STATES             |   1993 | 4675917303.64771
 UNITED STATES             |   1992 |   4680091625.843
 VIETNAM                   |   1998 | 2731500687.93604
 VIETNAM                   |   1997 | 4638936691.58586
 VIETNAM                   |   1996 | 4682625112.79668
 VIETNAM                   |   1995 | 4689257237.76483
 VIETNAM                   |   1994 | 4669640727.35259
 VIETNAM                   |   1993 | 4664869337.93685
 VIETNAM                   |   1992 | 4670425379.39457
(175 rows)

COMMIT;
COMMIT
