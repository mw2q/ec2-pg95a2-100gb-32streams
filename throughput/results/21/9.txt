BEGIN;
BEGIN
select
	nation,
	o_year,
	sum(amount) as sum_profit
from
	(
		select
			n_name as nation,
			extract(year from o_orderdate) as o_year,
			l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount
		from
			part,
			supplier,
			lineitem,
			partsupp,
			orders,
			nation
		where
			s_suppkey = l_suppkey
			and ps_suppkey = l_suppkey
			and ps_partkey = l_partkey
			and p_partkey = l_partkey
			and o_orderkey = l_orderkey
			and s_nationkey = n_nationkey
			and p_name like '%pink%'
	) as profit
group by
	nation,
	o_year
order by
	nation,
	o_year desc;
          nation           | o_year |    sum_profit    
---------------------------+--------+------------------
 ALGERIA                   |   1998 | 2742990123.77182
 ALGERIA                   |   1997 | 4669937994.50697
 ALGERIA                   |   1996 | 4683529234.76265
 ALGERIA                   |   1995 | 4664984831.13446
 ALGERIA                   |   1994 | 4655696255.26141
 ALGERIA                   |   1993 |   4642661704.313
 ALGERIA                   |   1992 | 4703072315.42792
 ARGENTINA                 |   1998 | 2682368875.42159
 ARGENTINA                 |   1997 |  4623343494.7925
 ARGENTINA                 |   1996 | 4634344214.78873
 ARGENTINA                 |   1995 | 4616965563.29216
 ARGENTINA                 |   1994 | 4619872182.13671
 ARGENTINA                 |   1993 | 4615711637.22156
 ARGENTINA                 |   1992 | 4639646758.75021
 BRAZIL                    |   1998 | 2746251716.73357
 BRAZIL                    |   1997 | 4667349377.34692
 BRAZIL                    |   1996 | 4683619562.86949
 BRAZIL                    |   1995 | 4681574048.93819
 BRAZIL                    |   1994 | 4670547647.13271
 BRAZIL                    |   1993 | 4668251038.17356
 BRAZIL                    |   1992 |  4690239395.6846
 CANADA                    |   1998 | 2737049054.62931
 CANADA                    |   1997 |  4650660617.0093
 CANADA                    |   1996 | 4669880497.66269
 CANADA                    |   1995 | 4660199129.45997
 CANADA                    |   1994 | 4670903012.73395
 CANADA                    |   1993 | 4652834875.58492
 CANADA                    |   1992 | 4676623871.02891
 CHINA                     |   1998 | 2749054978.46447
 CHINA                     |   1997 | 4658659223.62157
 CHINA                     |   1996 |  4734267988.0151
 CHINA                     |   1995 | 4685939391.86381
 CHINA                     |   1994 | 4683095374.87562
 CHINA                     |   1993 | 4691180310.51999
 CHINA                     |   1992 | 4697739922.77964
 EGYPT                     |   1998 | 2745584769.24936
 EGYPT                     |   1997 | 4649699176.61366
 EGYPT                     |   1996 | 4691433972.73116
 EGYPT                     |   1995 | 4701280138.05102
 EGYPT                     |   1994 | 4671699696.50857
 EGYPT                     |   1993 | 4691172295.25542
 EGYPT                     |   1992 | 4691176079.10431
 ETHIOPIA                  |   1998 | 2758207198.23069
 ETHIOPIA                  |   1997 | 4707558973.50659
 ETHIOPIA                  |   1996 | 4720032317.11535
 ETHIOPIA                  |   1995 | 4705066559.96341
 ETHIOPIA                  |   1994 | 4720306287.78024
 ETHIOPIA                  |   1993 | 4700190478.01688
 ETHIOPIA                  |   1992 | 4726121732.15069
 FRANCE                    |   1998 | 2738008670.54901
 FRANCE                    |   1997 | 4697934996.66107
 FRANCE                    |   1996 | 4715483941.88311
 FRANCE                    |   1995 |  4659188304.9947
 FRANCE                    |   1994 | 4672653400.21749
 FRANCE                    |   1993 | 4656249134.33906
 FRANCE                    |   1992 | 4681695339.03493
 GERMANY                   |   1998 | 2749495670.28681
 GERMANY                   |   1997 |  4672301855.9846
 GERMANY                   |   1996 | 4702516077.73891
 GERMANY                   |   1995 | 4691921795.69873
 GERMANY                   |   1994 | 4680157361.27615
 GERMANY                   |   1993 | 4685298645.08688
 GERMANY                   |   1992 |  4692147985.0752
 INDIA                     |   1998 | 2735429765.73849
 INDIA                     |   1997 | 4648151476.59192
 INDIA                     |   1996 | 4666080375.47125
 INDIA                     |   1995 | 4626459458.03805
 INDIA                     |   1994 | 4631666932.14565
 INDIA                     |   1993 | 4657436218.90895
 INDIA                     |   1992 | 4673680341.23927
 INDONESIA                 |   1998 | 2740264566.56455
 INDONESIA                 |   1997 | 4630886771.25768
 INDONESIA                 |   1996 | 4647153033.31212
 INDONESIA                 |   1995 | 4644220663.48059
 INDONESIA                 |   1994 | 4634366286.79955
 INDONESIA                 |   1993 | 4655253535.49399
 INDONESIA                 |   1992 | 4667894709.82123
 IRAN                      |   1998 | 2716004220.68816
 IRAN                      |   1997 | 4660152429.68553
 IRAN                      |   1996 | 4649754908.22657
 IRAN                      |   1995 | 4670658311.63571
 IRAN                      |   1994 | 4681920481.20583
 IRAN                      |   1993 | 4635773411.58489
 IRAN                      |   1992 | 4663741974.99312
 IRAQ                      |   1998 | 2717096580.30433
 IRAQ                      |   1997 | 4645650127.90196
 IRAQ                      |   1996 | 4663859581.22053
 IRAQ                      |   1995 | 4642766361.76292
 IRAQ                      |   1994 | 4643208268.69849
 IRAQ                      |   1993 | 4627603837.96639
 IRAQ                      |   1992 | 4646983367.92261
 JAPAN                     |   1998 | 2740069677.02497
 JAPAN                     |   1997 | 4664689121.75948
 JAPAN                     |   1996 | 4677285462.68479
 JAPAN                     |   1995 | 4641103776.35782
 JAPAN                     |   1994 |  4657238239.5574
 JAPAN                     |   1993 |  4627881287.7388
 JAPAN                     |   1992 | 4670870505.50366
 JORDAN                    |   1998 | 2749631034.70747
 JORDAN                    |   1997 | 4652519669.86341
 JORDAN                    |   1996 | 4714599686.31079
 JORDAN                    |   1995 | 4684791358.08388
 JORDAN                    |   1994 | 4647841707.91322
 JORDAN                    |   1993 | 4639827495.90786
 JORDAN                    |   1992 |  4686141759.5849
 KENYA                     |   1998 |  2714912216.9274
 KENYA                     |   1997 | 4628897717.82149
 KENYA                     |   1996 | 4644231928.18265
 KENYA                     |   1995 |  4648543614.1198
 KENYA                     |   1994 | 4631656898.54057
 KENYA                     |   1993 | 4650508228.76754
 KENYA                     |   1992 | 4644052624.25921
 MOROCCO                   |   1998 | 2727833454.72394
 MOROCCO                   |   1997 | 4672201373.22111
 MOROCCO                   |   1996 | 4676997956.02968
 MOROCCO                   |   1995 | 4683725868.04811
 MOROCCO                   |   1994 | 4679267776.58661
 MOROCCO                   |   1993 | 4681392877.31882
 MOROCCO                   |   1992 | 4697496754.26847
 MOZAMBIQUE                |   1998 | 2744459765.00614
 MOZAMBIQUE                |   1997 | 4668233265.41873
 MOZAMBIQUE                |   1996 | 4685671110.44503
 MOZAMBIQUE                |   1995 | 4654221283.47409
 MOZAMBIQUE                |   1994 | 4638321313.67724
 MOZAMBIQUE                |   1993 |  4661230843.7476
 MOZAMBIQUE                |   1992 | 4670650663.48471
 PERU                      |   1998 | 2701188769.97055
 PERU                      |   1997 | 4607899745.83659
 PERU                      |   1996 | 4616300923.17412
 PERU                      |   1995 | 4609036029.16891
 PERU                      |   1994 | 4632529767.89018
 PERU                      |   1993 | 4600268000.29654
 PERU                      |   1992 | 4638514319.01505
 ROMANIA                   |   1998 |  2753720263.4007
 ROMANIA                   |   1997 | 4672625878.91658
 ROMANIA                   |   1996 | 4706852132.84195
 ROMANIA                   |   1995 | 4687981177.57615
 ROMANIA                   |   1994 | 4687583991.26162
 ROMANIA                   |   1993 | 4663559287.30334
 ROMANIA                   |   1992 | 4711351451.81468
 RUSSIA                    |   1998 | 2725799601.79788
 RUSSIA                    |   1997 | 4629594624.55965
 RUSSIA                    |   1996 | 4677944588.10122
 RUSSIA                    |   1995 | 4643763336.90326
 RUSSIA                    |   1994 | 4646604803.13981
 RUSSIA                    |   1993 | 4676285715.59811
 RUSSIA                    |   1992 | 4669711173.81584
 SAUDI ARABIA              |   1998 | 2727020715.13505
 SAUDI ARABIA              |   1997 |  4638593537.6912
 SAUDI ARABIA              |   1996 | 4676790736.52141
 SAUDI ARABIA              |   1995 | 4649410824.04286
 SAUDI ARABIA              |   1994 | 4640664278.27353
 SAUDI ARABIA              |   1993 | 4633339604.12501
 SAUDI ARABIA              |   1992 | 4662079138.57509
 UNITED KINGDOM            |   1998 | 2754424321.38921
 UNITED KINGDOM            |   1997 | 4691455344.53254
 UNITED KINGDOM            |   1996 |  4725139751.4072
 UNITED KINGDOM            |   1995 | 4689475709.27743
 UNITED KINGDOM            |   1994 | 4679449478.44009
 UNITED KINGDOM            |   1993 | 4705870847.56477
 UNITED KINGDOM            |   1992 | 4732663281.32775
 UNITED STATES             |   1998 | 2750740109.38467
 UNITED STATES             |   1997 | 4660746498.90855
 UNITED STATES             |   1996 | 4693124336.22048
 UNITED STATES             |   1995 | 4671897088.17274
 UNITED STATES             |   1994 | 4696554908.55684
 UNITED STATES             |   1993 | 4674078503.14229
 UNITED STATES             |   1992 | 4657925173.58329
 VIETNAM                   |   1998 | 2760581059.50642
 VIETNAM                   |   1997 | 4693442567.25699
 VIETNAM                   |   1996 | 4704134592.80124
 VIETNAM                   |   1995 | 4717449374.48365
 VIETNAM                   |   1994 |  4707073503.3006
 VIETNAM                   |   1993 | 4691235503.00394
 VIETNAM                   |   1992 | 4705550597.48228
(175 rows)

COMMIT;
COMMIT
