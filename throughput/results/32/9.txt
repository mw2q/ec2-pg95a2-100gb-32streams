BEGIN;
BEGIN
select
	nation,
	o_year,
	sum(amount) as sum_profit
from
	(
		select
			n_name as nation,
			extract(year from o_orderdate) as o_year,
			l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount
		from
			part,
			supplier,
			lineitem,
			partsupp,
			orders,
			nation
		where
			s_suppkey = l_suppkey
			and ps_suppkey = l_suppkey
			and ps_partkey = l_partkey
			and p_partkey = l_partkey
			and o_orderkey = l_orderkey
			and s_nationkey = n_nationkey
			and p_name like '%white%'
	) as profit
group by
	nation,
	o_year
order by
	nation,
	o_year desc;
          nation           | o_year |    sum_profit    
---------------------------+--------+------------------
 ALGERIA                   |   1998 | 2747082328.07094
 ALGERIA                   |   1997 | 4689829331.32599
 ALGERIA                   |   1996 | 4717695635.44647
 ALGERIA                   |   1995 | 4691912936.98783
 ALGERIA                   |   1994 | 4690165970.96445
 ALGERIA                   |   1993 | 4659282526.09052
 ALGERIA                   |   1992 |  4705794099.4202
 ARGENTINA                 |   1998 | 2744964760.22622
 ARGENTINA                 |   1997 | 4676310831.70944
 ARGENTINA                 |   1996 | 4692661009.22731
 ARGENTINA                 |   1995 | 4649046945.15483
 ARGENTINA                 |   1994 | 4674249132.46752
 ARGENTINA                 |   1993 |  4650271685.3564
 ARGENTINA                 |   1992 | 4668456032.61468
 BRAZIL                    |   1998 | 2738813277.84873
 BRAZIL                    |   1997 | 4657433327.72806
 BRAZIL                    |   1996 | 4687978080.41017
 BRAZIL                    |   1995 | 4683550055.88403
 BRAZIL                    |   1994 | 4655057960.66878
 BRAZIL                    |   1993 | 4676718419.98773
 BRAZIL                    |   1992 | 4702038608.09795
 CANADA                    |   1998 | 2734459027.09157
 CANADA                    |   1997 | 4663205982.18696
 CANADA                    |   1996 | 4704204814.94353
 CANADA                    |   1995 | 4666606081.39677
 CANADA                    |   1994 | 4674336143.15574
 CANADA                    |   1993 | 4657579436.02892
 CANADA                    |   1992 | 4680042847.37351
 CHINA                     |   1998 | 2742751024.96297
 CHINA                     |   1997 | 4689942405.60548
 CHINA                     |   1996 | 4674838807.62074
 CHINA                     |   1995 | 4661711776.42994
 CHINA                     |   1994 |  4682506385.7447
 CHINA                     |   1993 | 4676725936.66431
 CHINA                     |   1992 | 4685556163.42777
 EGYPT                     |   1998 |    2743246022.69
 EGYPT                     |   1997 | 4676636569.61722
 EGYPT                     |   1996 | 4679112959.78933
 EGYPT                     |   1995 |  4677482657.8173
 EGYPT                     |   1994 | 4680023889.63205
 EGYPT                     |   1993 | 4685725845.72189
 EGYPT                     |   1992 | 4693522376.89846
 ETHIOPIA                  |   1998 | 2778562339.97662
 ETHIOPIA                  |   1997 | 4694358778.95076
 ETHIOPIA                  |   1996 | 4719738051.09651
 ETHIOPIA                  |   1995 | 4713329172.54096
 ETHIOPIA                  |   1994 | 4735404155.74923
 ETHIOPIA                  |   1993 | 4709346744.05597
 ETHIOPIA                  |   1992 | 4722515542.88504
 FRANCE                    |   1998 | 2749890336.69627
 FRANCE                    |   1997 | 4683593516.52877
 FRANCE                    |   1996 | 4688476020.18454
 FRANCE                    |   1995 | 4669006444.69552
 FRANCE                    |   1994 | 4668133354.08595
 FRANCE                    |   1993 | 4655738177.86573
 FRANCE                    |   1992 | 4694278782.72182
 GERMANY                   |   1998 | 2749296848.62772
 GERMANY                   |   1997 | 4661100452.17562
 GERMANY                   |   1996 | 4667628941.99044
 GERMANY                   |   1995 | 4669164315.62944
 GERMANY                   |   1994 | 4684916849.73662
 GERMANY                   |   1993 | 4664674375.09146
 GERMANY                   |   1992 | 4682450888.92543
 INDIA                     |   1998 | 2762978677.31096
 INDIA                     |   1997 | 4707877778.74731
 INDIA                     |   1996 | 4681298767.91862
 INDIA                     |   1995 | 4679966135.73755
 INDIA                     |   1994 | 4672728786.96881
 INDIA                     |   1993 | 4658401345.78124
 INDIA                     |   1992 | 4703684160.71223
 INDONESIA                 |   1998 | 2715488091.76327
 INDONESIA                 |   1997 | 4615802457.96332
 INDONESIA                 |   1996 | 4624446349.88541
 INDONESIA                 |   1995 |  4615144149.7431
 INDONESIA                 |   1994 | 4624382546.89667
 INDONESIA                 |   1993 | 4617849348.47101
 INDONESIA                 |   1992 | 4642841775.62941
 IRAN                      |   1998 | 2736147661.20693
 IRAN                      |   1997 | 4646779556.13911
 IRAN                      |   1996 | 4671630862.55383
 IRAN                      |   1995 | 4655494182.62018
 IRAN                      |   1994 | 4656045416.14612
 IRAN                      |   1993 | 4642492535.98507
 IRAN                      |   1992 | 4672743928.65887
 IRAQ                      |   1998 | 2725971199.51419
 IRAQ                      |   1997 |  4658421490.9002
 IRAQ                      |   1996 | 4672594025.25902
 IRAQ                      |   1995 | 4659966848.21606
 IRAQ                      |   1994 | 4646419125.48847
 IRAQ                      |   1993 |  4659098162.6692
 IRAQ                      |   1992 | 4687450629.52746
 JAPAN                     |   1998 | 2717597406.87244
 JAPAN                     |   1997 |  4674125685.5937
 JAPAN                     |   1996 | 4650391346.36428
 JAPAN                     |   1995 | 4633789320.86719
 JAPAN                     |   1994 | 4652156540.97863
 JAPAN                     |   1993 | 4634403375.19063
 JAPAN                     |   1992 | 4644034639.38541
 JORDAN                    |   1998 | 2738393679.26201
 JORDAN                    |   1997 | 4678229624.94562
 JORDAN                    |   1996 | 4678236740.72629
 JORDAN                    |   1995 | 4666681473.44414
 JORDAN                    |   1994 |  4670613753.5882
 JORDAN                    |   1993 | 4666058702.37687
 JORDAN                    |   1992 | 4693306128.36042
 KENYA                     |   1998 | 2701121220.95015
 KENYA                     |   1997 | 4619853210.42757
 KENYA                     |   1996 | 4657873786.11769
 KENYA                     |   1995 | 4624287323.45088
 KENYA                     |   1994 | 4649255983.88949
 KENYA                     |   1993 | 4661996104.98932
 KENYA                     |   1992 | 4653665506.00879
 MOROCCO                   |   1998 |  2724115343.3142
 MOROCCO                   |   1997 | 4665146658.35599
 MOROCCO                   |   1996 | 4677752107.12999
 MOROCCO                   |   1995 | 4649735496.02788
 MOROCCO                   |   1994 | 4654810007.51891
 MOROCCO                   |   1993 | 4650490528.94417
 MOROCCO                   |   1992 | 4684666737.93646
 MOZAMBIQUE                |   1998 | 2746576117.74063
 MOZAMBIQUE                |   1997 | 4697480517.98102
 MOZAMBIQUE                |   1996 | 4690692609.97226
 MOZAMBIQUE                |   1995 | 4636734129.98455
 MOZAMBIQUE                |   1994 | 4675207817.74432
 MOZAMBIQUE                |   1993 | 4662374266.21255
 MOZAMBIQUE                |   1992 | 4664777843.02942
 PERU                      |   1998 | 2698519659.49401
 PERU                      |   1997 | 4622067204.98775
 PERU                      |   1996 | 4615444476.83128
 PERU                      |   1995 | 4601711898.99962
 PERU                      |   1994 | 4601116963.96589
 PERU                      |   1993 | 4632623025.69182
 PERU                      |   1992 | 4608164139.49679
 ROMANIA                   |   1998 | 2731063634.61445
 ROMANIA                   |   1997 | 4665012569.36057
 ROMANIA                   |   1996 | 4656174302.96122
 ROMANIA                   |   1995 | 4668348536.19853
 ROMANIA                   |   1994 | 4691275116.77976
 ROMANIA                   |   1993 | 4655439608.97162
 ROMANIA                   |   1992 | 4701189114.93317
 RUSSIA                    |   1998 | 2710622298.58513
 RUSSIA                    |   1997 | 4646270450.96707
 RUSSIA                    |   1996 | 4672870624.23647
 RUSSIA                    |   1995 | 4646093226.75407
 RUSSIA                    |   1994 | 4674756277.89608
 RUSSIA                    |   1993 | 4652845640.48977
 RUSSIA                    |   1992 | 4674290226.85198
 SAUDI ARABIA              |   1998 | 2725230215.07515
 SAUDI ARABIA              |   1997 | 4642198790.76608
 SAUDI ARABIA              |   1996 | 4662771962.71924
 SAUDI ARABIA              |   1995 | 4659250156.43407
 SAUDI ARABIA              |   1994 | 4664602301.28377
 SAUDI ARABIA              |   1993 | 4650047624.60576
 SAUDI ARABIA              |   1992 | 4646549712.82165
 UNITED KINGDOM            |   1998 |  2768244779.9352
 UNITED KINGDOM            |   1997 |  4689138375.2921
 UNITED KINGDOM            |   1996 | 4719970370.25953
 UNITED KINGDOM            |   1995 | 4671194447.58801
 UNITED KINGDOM            |   1994 | 4712801792.13928
 UNITED KINGDOM            |   1993 | 4703482340.23716
 UNITED KINGDOM            |   1992 | 4716915596.45379
 UNITED STATES             |   1998 | 2733460040.61531
 UNITED STATES             |   1997 | 4666705821.11097
 UNITED STATES             |   1996 | 4696041121.03965
 UNITED STATES             |   1995 | 4679907739.26531
 UNITED STATES             |   1994 | 4672256468.12045
 UNITED STATES             |   1993 | 4671751743.55564
 UNITED STATES             |   1992 | 4676840853.84591
 VIETNAM                   |   1998 | 2738615616.05932
 VIETNAM                   |   1997 | 4680598282.52342
 VIETNAM                   |   1996 | 4699890073.49926
 VIETNAM                   |   1995 | 4704117781.05116
 VIETNAM                   |   1994 | 4685186417.64982
 VIETNAM                   |   1993 | 4671953485.89538
 VIETNAM                   |   1992 | 4681011503.06897
(175 rows)

COMMIT;
COMMIT
