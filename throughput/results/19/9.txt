BEGIN;
BEGIN
select
	nation,
	o_year,
	sum(amount) as sum_profit
from
	(
		select
			n_name as nation,
			extract(year from o_orderdate) as o_year,
			l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount
		from
			part,
			supplier,
			lineitem,
			partsupp,
			orders,
			nation
		where
			s_suppkey = l_suppkey
			and ps_suppkey = l_suppkey
			and ps_partkey = l_partkey
			and p_partkey = l_partkey
			and o_orderkey = l_orderkey
			and s_nationkey = n_nationkey
			and p_name like '%seashell%'
	) as profit
group by
	nation,
	o_year
order by
	nation,
	o_year desc;
          nation           | o_year |    sum_profit    
---------------------------+--------+------------------
 ALGERIA                   |   1998 | 2727262948.23705
 ALGERIA                   |   1997 | 4677344246.88605
 ALGERIA                   |   1996 | 4662729871.25634
 ALGERIA                   |   1995 | 4641825271.22215
 ALGERIA                   |   1994 | 4653998789.20553
 ALGERIA                   |   1993 | 4641691796.74722
 ALGERIA                   |   1992 | 4672866605.38077
 ARGENTINA                 |   1998 | 2718372832.42994
 ARGENTINA                 |   1997 |  4642654735.4461
 ARGENTINA                 |   1996 | 4640279326.12325
 ARGENTINA                 |   1995 | 4630434867.35069
 ARGENTINA                 |   1994 | 4637799569.55386
 ARGENTINA                 |   1993 | 4647660667.60328
 ARGENTINA                 |   1992 | 4634772492.29695
 BRAZIL                    |   1998 | 2755702284.51291
 BRAZIL                    |   1997 | 4692049915.73933
 BRAZIL                    |   1996 | 4692165539.05645
 BRAZIL                    |   1995 | 4693699307.25038
 BRAZIL                    |   1994 | 4678164559.19019
 BRAZIL                    |   1993 |  4697571757.9922
 BRAZIL                    |   1992 | 4665130286.28544
 CANADA                    |   1998 | 2771962926.31248
 CANADA                    |   1997 | 4696354312.89544
 CANADA                    |   1996 | 4741815348.28749
 CANADA                    |   1995 | 4719393026.03361
 CANADA                    |   1994 | 4702336857.78049
 CANADA                    |   1993 | 4690311755.19484
 CANADA                    |   1992 | 4729952839.95701
 CHINA                     |   1998 | 2723265808.49367
 CHINA                     |   1997 | 4676286124.70951
 CHINA                     |   1996 | 4694017598.20174
 CHINA                     |   1995 | 4669380342.58752
 CHINA                     |   1994 | 4667784691.28478
 CHINA                     |   1993 | 4665458345.82971
 CHINA                     |   1992 | 4707804677.48671
 EGYPT                     |   1998 | 2735270632.31971
 EGYPT                     |   1997 | 4666389424.86068
 EGYPT                     |   1996 | 4685961942.73329
 EGYPT                     |   1995 |  4693639219.7147
 EGYPT                     |   1994 | 4676954241.31841
 EGYPT                     |   1993 | 4656159564.18353
 EGYPT                     |   1992 |  4669787798.0556
 ETHIOPIA                  |   1998 | 2755623817.59433
 ETHIOPIA                  |   1997 | 4710494841.19784
 ETHIOPIA                  |   1996 | 4738740066.16185
 ETHIOPIA                  |   1995 | 4696051235.72892
 ETHIOPIA                  |   1994 | 4718409499.56696
 ETHIOPIA                  |   1993 | 4711698836.35152
 ETHIOPIA                  |   1992 | 4710678817.18194
 FRANCE                    |   1998 | 2741429204.51392
 FRANCE                    |   1997 | 4697444006.09621
 FRANCE                    |   1996 | 4717438795.59251
 FRANCE                    |   1995 | 4691365909.91969
 FRANCE                    |   1994 | 4713383495.40204
 FRANCE                    |   1993 | 4710356205.62756
 FRANCE                    |   1992 | 4707348239.81105
 GERMANY                   |   1998 | 2763473047.12504
 GERMANY                   |   1997 | 4690930179.93983
 GERMANY                   |   1996 | 4699896598.66606
 GERMANY                   |   1995 | 4687721084.23625
 GERMANY                   |   1994 | 4705127341.91009
 GERMANY                   |   1993 | 4705209253.56874
 GERMANY                   |   1992 | 4715521863.40046
 INDIA                     |   1998 | 2750473543.48234
 INDIA                     |   1997 |  4684022469.7589
 INDIA                     |   1996 | 4691754468.92287
 INDIA                     |   1995 |  4686772423.7848
 INDIA                     |   1994 | 4672035216.50283
 INDIA                     |   1993 | 4662399701.02977
 INDIA                     |   1992 | 4685389748.51797
 INDONESIA                 |   1998 |  2734299185.8483
 INDONESIA                 |   1997 |  4660149369.2593
 INDONESIA                 |   1996 | 4662833020.04577
 INDONESIA                 |   1995 | 4663179470.90379
 INDONESIA                 |   1994 | 4658130172.12982
 INDONESIA                 |   1993 | 4635270304.56873
 INDONESIA                 |   1992 | 4661062622.13468
 IRAN                      |   1998 |  2722964229.0212
 IRAN                      |   1997 | 4664491352.98341
 IRAN                      |   1996 | 4661398841.56079
 IRAN                      |   1995 |  4660462333.6424
 IRAN                      |   1994 |  4659866083.4629
 IRAN                      |   1993 |  4636508762.2731
 IRAN                      |   1992 |  4647780280.4893
 IRAQ                      |   1998 | 2731872194.30628
 IRAQ                      |   1997 | 4696124160.42438
 IRAQ                      |   1996 | 4667475486.36945
 IRAQ                      |   1995 | 4644740928.25583
 IRAQ                      |   1994 | 4647720312.02315
 IRAQ                      |   1993 | 4657175326.66545
 IRAQ                      |   1992 | 4674596231.68126
 JAPAN                     |   1998 | 2735944088.51488
 JAPAN                     |   1997 | 4658787744.15455
 JAPAN                     |   1996 | 4660579467.13832
 JAPAN                     |   1995 | 4639359621.73874
 JAPAN                     |   1994 | 4685526717.43856
 JAPAN                     |   1993 | 4653434088.49153
 JAPAN                     |   1992 | 4648589776.91001
 JORDAN                    |   1998 | 2721922973.81226
 JORDAN                    |   1997 | 4639286662.78813
 JORDAN                    |   1996 | 4674325984.15889
 JORDAN                    |   1995 | 4652492807.12621
 JORDAN                    |   1994 | 4652680390.77853
 JORDAN                    |   1993 | 4646128519.90837
 JORDAN                    |   1992 | 4631474245.56885
 KENYA                     |   1998 | 2706599156.63604
 KENYA                     |   1997 | 4623455263.60823
 KENYA                     |   1996 | 4633078101.82689
 KENYA                     |   1995 | 4636387198.43975
 KENYA                     |   1994 |  4612338855.6313
 KENYA                     |   1993 |   4627727117.253
 KENYA                     |   1992 | 4625243005.44307
 MOROCCO                   |   1998 | 2757874666.64309
 MOROCCO                   |   1997 |  4727887953.6065
 MOROCCO                   |   1996 | 4717470625.58852
 MOROCCO                   |   1995 | 4723072114.90007
 MOROCCO                   |   1994 | 4712535078.85152
 MOROCCO                   |   1993 | 4717112971.90031
 MOROCCO                   |   1992 | 4710925633.83094
 MOZAMBIQUE                |   1998 | 2732287495.54912
 MOZAMBIQUE                |   1997 | 4676403765.12859
 MOZAMBIQUE                |   1996 | 4680840952.94797
 MOZAMBIQUE                |   1995 | 4654027281.29209
 MOZAMBIQUE                |   1994 | 4654858216.93105
 MOZAMBIQUE                |   1993 | 4681596950.02459
 MOZAMBIQUE                |   1992 | 4699761810.07292
 PERU                      |   1998 | 2717774341.89307
 PERU                      |   1997 | 4645062013.58893
 PERU                      |   1996 | 4645806919.39722
 PERU                      |   1995 | 4617035608.43071
 PERU                      |   1994 | 4623290716.80566
 PERU                      |   1993 | 4612898091.35078
 PERU                      |   1992 | 4649164182.76763
 ROMANIA                   |   1998 | 2762427259.36089
 ROMANIA                   |   1997 | 4684392274.34285
 ROMANIA                   |   1996 |  4722817888.1202
 ROMANIA                   |   1995 | 4685445978.36975
 ROMANIA                   |   1994 | 4711914509.23025
 ROMANIA                   |   1993 | 4693573429.35788
 ROMANIA                   |   1992 | 4716175010.47011
 RUSSIA                    |   1998 | 2700768508.80387
 RUSSIA                    |   1997 | 4629067180.54039
 RUSSIA                    |   1996 | 4658900873.83843
 RUSSIA                    |   1995 | 4632683819.44498
 RUSSIA                    |   1994 | 4648893262.99328
 RUSSIA                    |   1993 | 4634836563.24118
 RUSSIA                    |   1992 | 4638082501.08459
 SAUDI ARABIA              |   1998 | 2752598013.70154
 SAUDI ARABIA              |   1997 | 4683678980.57728
 SAUDI ARABIA              |   1996 |  4680757888.5219
 SAUDI ARABIA              |   1995 | 4684922664.01103
 SAUDI ARABIA              |   1994 | 4712404687.68505
 SAUDI ARABIA              |   1993 | 4678439686.53331
 SAUDI ARABIA              |   1992 | 4711246788.44974
 UNITED KINGDOM            |   1998 | 2761665806.44754
 UNITED KINGDOM            |   1997 | 4708406859.77749
 UNITED KINGDOM            |   1996 | 4728137175.57187
 UNITED KINGDOM            |   1995 | 4678004593.98657
 UNITED KINGDOM            |   1994 | 4726248175.83504
 UNITED KINGDOM            |   1993 | 4702150664.83675
 UNITED KINGDOM            |   1992 |  4699816378.8211
 UNITED STATES             |   1998 | 2728839010.17408
 UNITED STATES             |   1997 | 4686334829.08057
 UNITED STATES             |   1996 | 4677542439.88663
 UNITED STATES             |   1995 | 4648966966.70711
 UNITED STATES             |   1994 | 4680430012.76723
 UNITED STATES             |   1993 | 4680361738.23448
 UNITED STATES             |   1992 | 4688605175.35142
 VIETNAM                   |   1998 | 2750746261.98805
 VIETNAM                   |   1997 | 4680829431.74147
 VIETNAM                   |   1996 | 4706388195.84407
 VIETNAM                   |   1995 | 4671955222.35843
 VIETNAM                   |   1994 | 4694249406.42064
 VIETNAM                   |   1993 |  4694646362.9877
 VIETNAM                   |   1992 | 4711736165.97099
(175 rows)

COMMIT;
COMMIT
