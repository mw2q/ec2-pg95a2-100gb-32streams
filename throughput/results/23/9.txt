BEGIN;
BEGIN
select
	nation,
	o_year,
	sum(amount) as sum_profit
from
	(
		select
			n_name as nation,
			extract(year from o_orderdate) as o_year,
			l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount
		from
			part,
			supplier,
			lineitem,
			partsupp,
			orders,
			nation
		where
			s_suppkey = l_suppkey
			and ps_suppkey = l_suppkey
			and ps_partkey = l_partkey
			and p_partkey = l_partkey
			and o_orderkey = l_orderkey
			and s_nationkey = n_nationkey
			and p_name like '%mint%'
	) as profit
group by
	nation,
	o_year
order by
	nation,
	o_year desc;
          nation           | o_year |    sum_profit    
---------------------------+--------+------------------
 ALGERIA                   |   1998 | 2721188783.42897
 ALGERIA                   |   1997 | 4664508373.32317
 ALGERIA                   |   1996 | 4689989378.91674
 ALGERIA                   |   1995 |  4663245942.6901
 ALGERIA                   |   1994 | 4681545847.35332
 ALGERIA                   |   1993 | 4660665433.92288
 ALGERIA                   |   1992 | 4669315557.23951
 ARGENTINA                 |   1998 | 2719736049.78383
 ARGENTINA                 |   1997 | 4659001934.27095
 ARGENTINA                 |   1996 | 4681271697.28774
 ARGENTINA                 |   1995 | 4663894837.16959
 ARGENTINA                 |   1994 |   4632321205.662
 ARGENTINA                 |   1993 | 4683246075.21752
 ARGENTINA                 |   1992 |  4664856795.3482
 BRAZIL                    |   1998 | 2735455998.01121
 BRAZIL                    |   1997 | 4686576994.62183
 BRAZIL                    |   1996 | 4713126559.25172
 BRAZIL                    |   1995 | 4681614887.41297
 BRAZIL                    |   1994 | 4669796171.01682
 BRAZIL                    |   1993 | 4708711563.70207
 BRAZIL                    |   1992 | 4688396271.42214
 CANADA                    |   1998 | 2746751641.15016
 CANADA                    |   1997 | 4679238243.56837
 CANADA                    |   1996 | 4697414656.84888
 CANADA                    |   1995 | 4696269412.11746
 CANADA                    |   1994 |  4686806363.0824
 CANADA                    |   1993 | 4691594396.02558
 CANADA                    |   1992 |  4715558757.8258
 CHINA                     |   1998 | 2733877682.40329
 CHINA                     |   1997 | 4643434678.28685
 CHINA                     |   1996 |  4685276353.8627
 CHINA                     |   1995 | 4652817061.58079
 CHINA                     |   1994 | 4674151937.35889
 CHINA                     |   1993 | 4662729139.13209
 CHINA                     |   1992 | 4688103438.64042
 EGYPT                     |   1998 | 2741403934.89541
 EGYPT                     |   1997 | 4657025764.07434
 EGYPT                     |   1996 | 4674125845.72524
 EGYPT                     |   1995 | 4643420639.88907
 EGYPT                     |   1994 | 4658986774.27129
 EGYPT                     |   1993 | 4644550330.33331
 EGYPT                     |   1992 | 4656735324.43396
 ETHIOPIA                  |   1998 | 2786776969.71385
 ETHIOPIA                  |   1997 | 4756405795.18792
 ETHIOPIA                  |   1996 | 4746151346.61492
 ETHIOPIA                  |   1995 | 4748368519.90661
 ETHIOPIA                  |   1994 | 4750672822.41562
 ETHIOPIA                  |   1993 | 4747033089.51008
 ETHIOPIA                  |   1992 | 4749890620.29673
 FRANCE                    |   1998 | 2747683858.06594
 FRANCE                    |   1997 | 4681163955.10121
 FRANCE                    |   1996 | 4693892492.38307
 FRANCE                    |   1995 | 4689508486.80529
 FRANCE                    |   1994 | 4700453754.74124
 FRANCE                    |   1993 | 4687688403.21179
 FRANCE                    |   1992 | 4707781725.98869
 GERMANY                   |   1998 | 2772574849.39012
 GERMANY                   |   1997 | 4687549730.91732
 GERMANY                   |   1996 | 4712459552.60609
 GERMANY                   |   1995 | 4713127700.45582
 GERMANY                   |   1994 | 4692891174.82737
 GERMANY                   |   1993 | 4692894931.50232
 GERMANY                   |   1992 | 4730623957.06029
 INDIA                     |   1998 |  2760697908.4438
 INDIA                     |   1997 |  4680350477.0367
 INDIA                     |   1996 | 4701433020.69081
 INDIA                     |   1995 | 4698838626.39973
 INDIA                     |   1994 | 4680489624.13005
 INDIA                     |   1993 | 4716875501.03716
 INDIA                     |   1992 | 4691285169.42926
 INDONESIA                 |   1998 |  2716583191.6383
 INDONESIA                 |   1997 | 4629455486.67854
 INDONESIA                 |   1996 | 4638580641.54979
 INDONESIA                 |   1995 | 4623527569.22313
 INDONESIA                 |   1994 |   4660725399.793
 INDONESIA                 |   1993 |   4611486908.584
 INDONESIA                 |   1992 | 4641446093.43594
 IRAN                      |   1998 | 2716704169.50508
 IRAN                      |   1997 | 4641380221.67504
 IRAN                      |   1996 | 4659568813.63244
 IRAN                      |   1995 | 4670427727.30645
 IRAN                      |   1994 | 4655619456.93191
 IRAN                      |   1993 | 4663856490.76582
 IRAN                      |   1992 | 4655067230.26075
 IRAQ                      |   1998 | 2724625462.92192
 IRAQ                      |   1997 | 4642223722.03507
 IRAQ                      |   1996 | 4636572620.51036
 IRAQ                      |   1995 | 4657232006.91123
 IRAQ                      |   1994 | 4643877518.89432
 IRAQ                      |   1993 | 4616864195.76535
 IRAQ                      |   1992 | 4645261801.82912
 JAPAN                     |   1998 | 2722577350.35503
 JAPAN                     |   1997 | 4641267845.45059
 JAPAN                     |   1996 | 4645548041.48767
 JAPAN                     |   1995 | 4630978046.89562
 JAPAN                     |   1994 | 4638089070.10072
 JAPAN                     |   1993 |  4624105709.7271
 JAPAN                     |   1992 | 4643045606.78548
 JORDAN                    |   1998 | 2730405444.00633
 JORDAN                    |   1997 | 4663717494.37341
 JORDAN                    |   1996 | 4693823223.36448
 JORDAN                    |   1995 | 4675923210.95002
 JORDAN                    |   1994 | 4679430175.44099
 JORDAN                    |   1993 | 4658893781.16944
 JORDAN                    |   1992 | 4683308424.39866
 KENYA                     |   1998 | 2717506110.38373
 KENYA                     |   1997 |  4622124492.9101
 KENYA                     |   1996 |  4654170163.9386
 KENYA                     |   1995 | 4626954001.47312
 KENYA                     |   1994 | 4636113998.31836
 KENYA                     |   1993 | 4660909525.59345
 KENYA                     |   1992 | 4647716143.77341
 MOROCCO                   |   1998 | 2753898540.86372
 MOROCCO                   |   1997 | 4648960309.78771
 MOROCCO                   |   1996 | 4705394378.23363
 MOROCCO                   |   1995 | 4679476646.14241
 MOROCCO                   |   1994 |   4659997280.518
 MOROCCO                   |   1993 | 4684456351.14703
 MOROCCO                   |   1992 | 4722942457.54129
 MOZAMBIQUE                |   1998 | 2742671470.46655
 MOZAMBIQUE                |   1997 | 4680601280.43991
 MOZAMBIQUE                |   1996 | 4668527001.59344
 MOZAMBIQUE                |   1995 | 4682762417.62415
 MOZAMBIQUE                |   1994 | 4649230465.24502
 MOZAMBIQUE                |   1993 | 4643567452.92453
 MOZAMBIQUE                |   1992 | 4683682092.34224
 PERU                      |   1998 | 2734780400.11789
 PERU                      |   1997 | 4662809201.04448
 PERU                      |   1996 | 4665739596.08455
 PERU                      |   1995 | 4652630985.64221
 PERU                      |   1994 | 4636393465.92324
 PERU                      |   1993 | 4649571594.78011
 PERU                      |   1992 | 4653347501.09903
 ROMANIA                   |   1998 | 2753111734.01087
 ROMANIA                   |   1997 | 4711994988.23692
 ROMANIA                   |   1996 | 4698624001.33686
 ROMANIA                   |   1995 | 4697559652.08895
 ROMANIA                   |   1994 | 4693321165.41276
 ROMANIA                   |   1993 | 4692741395.46244
 ROMANIA                   |   1992 | 4714448441.57782
 RUSSIA                    |   1998 | 2735817291.25126
 RUSSIA                    |   1997 | 4668837192.64294
 RUSSIA                    |   1996 | 4686975434.68484
 RUSSIA                    |   1995 | 4675547732.94353
 RUSSIA                    |   1994 | 4681091399.00075
 RUSSIA                    |   1993 | 4658878038.57132
 RUSSIA                    |   1992 | 4688340166.77621
 SAUDI ARABIA              |   1998 | 2734752143.17715
 SAUDI ARABIA              |   1997 | 4677849759.05676
 SAUDI ARABIA              |   1996 |  4657454985.2936
 SAUDI ARABIA              |   1995 | 4652685794.01322
 SAUDI ARABIA              |   1994 |  4688509686.6475
 SAUDI ARABIA              |   1993 | 4651363477.10491
 SAUDI ARABIA              |   1992 | 4677162852.06648
 UNITED KINGDOM            |   1998 | 2768449290.99499
 UNITED KINGDOM            |   1997 | 4747281317.77836
 UNITED KINGDOM            |   1996 | 4752452661.28444
 UNITED KINGDOM            |   1995 | 4724729566.85345
 UNITED KINGDOM            |   1994 | 4708308098.20371
 UNITED KINGDOM            |   1993 | 4732196234.19097
 UNITED KINGDOM            |   1992 | 4764902419.65243
 UNITED STATES             |   1998 | 2738919816.97718
 UNITED STATES             |   1997 | 4679248853.78537
 UNITED STATES             |   1996 |  4678455747.8962
 UNITED STATES             |   1995 | 4672943216.75472
 UNITED STATES             |   1994 | 4701697716.76357
 UNITED STATES             |   1993 | 4700325726.24308
 UNITED STATES             |   1992 | 4667925332.53038
 VIETNAM                   |   1998 | 2754941240.76046
 VIETNAM                   |   1997 | 4685922743.14278
 VIETNAM                   |   1996 | 4731636905.96353
 VIETNAM                   |   1995 | 4708016871.90325
 VIETNAM                   |   1994 | 4682003316.17918
 VIETNAM                   |   1993 | 4716076765.49907
 VIETNAM                   |   1992 | 4700243753.50973
(175 rows)

COMMIT;
COMMIT
