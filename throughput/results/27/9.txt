BEGIN;
BEGIN
select
	nation,
	o_year,
	sum(amount) as sum_profit
from
	(
		select
			n_name as nation,
			extract(year from o_orderdate) as o_year,
			l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount
		from
			part,
			supplier,
			lineitem,
			partsupp,
			orders,
			nation
		where
			s_suppkey = l_suppkey
			and ps_suppkey = l_suppkey
			and ps_partkey = l_partkey
			and p_partkey = l_partkey
			and o_orderkey = l_orderkey
			and s_nationkey = n_nationkey
			and p_name like '%forest%'
	) as profit
group by
	nation,
	o_year
order by
	nation,
	o_year desc;
          nation           | o_year |    sum_profit    
---------------------------+--------+------------------
 ALGERIA                   |   1998 | 2730888856.14621
 ALGERIA                   |   1997 | 4637568023.45858
 ALGERIA                   |   1996 | 4671591026.72771
 ALGERIA                   |   1995 |   4652379873.046
 ALGERIA                   |   1994 | 4650360303.56299
 ALGERIA                   |   1993 | 4623949036.40076
 ALGERIA                   |   1992 | 4657667402.09539
 ARGENTINA                 |   1998 | 2708061030.94698
 ARGENTINA                 |   1997 | 4630421652.51662
 ARGENTINA                 |   1996 | 4662398267.14256
 ARGENTINA                 |   1995 | 4624825834.94606
 ARGENTINA                 |   1994 | 4623101133.41426
 ARGENTINA                 |   1993 | 4589724910.39604
 ARGENTINA                 |   1992 | 4640339471.78475
 BRAZIL                    |   1998 | 2730928392.20643
 BRAZIL                    |   1997 | 4680714692.05424
 BRAZIL                    |   1996 | 4676351784.81746
 BRAZIL                    |   1995 | 4643382831.85854
 BRAZIL                    |   1994 | 4655709998.82361
 BRAZIL                    |   1993 | 4650728933.10314
 BRAZIL                    |   1992 | 4685475695.59361
 CANADA                    |   1998 | 2749601299.71615
 CANADA                    |   1997 | 4655282553.08451
 CANADA                    |   1996 |  4668158929.8859
 CANADA                    |   1995 | 4656329437.26587
 CANADA                    |   1994 |  4662386925.4507
 CANADA                    |   1993 | 4653942774.97648
 CANADA                    |   1992 | 4686855490.53954
 CHINA                     |   1998 | 2730231944.21641
 CHINA                     |   1997 | 4672181798.65444
 CHINA                     |   1996 | 4702597667.49653
 CHINA                     |   1995 |  4693054428.4324
 CHINA                     |   1994 | 4676258064.24327
 CHINA                     |   1993 | 4674286286.20818
 CHINA                     |   1992 | 4670692616.09091
 EGYPT                     |   1998 | 2729287241.77754
 EGYPT                     |   1997 | 4656841600.18882
 EGYPT                     |   1996 | 4688113686.54098
 EGYPT                     |   1995 | 4665122606.50798
 EGYPT                     |   1994 | 4669830386.70201
 EGYPT                     |   1993 | 4685814018.89404
 EGYPT                     |   1992 | 4680256990.92417
 ETHIOPIA                  |   1998 | 2748322194.51803
 ETHIOPIA                  |   1997 | 4683555738.64485
 ETHIOPIA                  |   1996 | 4698893059.57677
 ETHIOPIA                  |   1995 | 4687841628.72604
 ETHIOPIA                  |   1994 | 4708631293.43646
 ETHIOPIA                  |   1993 | 4686851276.71653
 ETHIOPIA                  |   1992 | 4713407200.28125
 FRANCE                    |   1998 |  2749338427.6301
 FRANCE                    |   1997 |  4703868942.6251
 FRANCE                    |   1996 | 4706900875.93808
 FRANCE                    |   1995 | 4696783723.35492
 FRANCE                    |   1994 | 4692903641.42923
 FRANCE                    |   1993 | 4693732779.63342
 FRANCE                    |   1992 | 4696777598.63042
 GERMANY                   |   1998 | 2746152752.74564
 GERMANY                   |   1997 | 4687401141.36498
 GERMANY                   |   1996 | 4692712197.57645
 GERMANY                   |   1995 | 4675973158.76052
 GERMANY                   |   1994 | 4694873893.31493
 GERMANY                   |   1993 | 4684938643.50046
 GERMANY                   |   1992 | 4681718468.77586
 INDIA                     |   1998 |  2729809577.1118
 INDIA                     |   1997 | 4657605689.85109
 INDIA                     |   1996 |  4674053622.3385
 INDIA                     |   1995 | 4661173804.13789
 INDIA                     |   1994 | 4651950477.00278
 INDIA                     |   1993 | 4684330289.80214
 INDIA                     |   1992 | 4678741053.48852
 INDONESIA                 |   1998 |  2729541979.9536
 INDONESIA                 |   1997 | 4669678767.68729
 INDONESIA                 |   1996 | 4651160370.93247
 INDONESIA                 |   1995 | 4655355848.86096
 INDONESIA                 |   1994 | 4651917003.93398
 INDONESIA                 |   1993 | 4657025856.59446
 INDONESIA                 |   1992 | 4671474656.46978
 IRAN                      |   1998 | 2739530666.20331
 IRAN                      |   1997 | 4666651951.39847
 IRAN                      |   1996 | 4675469597.49633
 IRAN                      |   1995 | 4634516654.37092
 IRAN                      |   1994 | 4645822867.90302
 IRAN                      |   1993 | 4659739117.67065
 IRAN                      |   1992 | 4658098241.79025
 IRAQ                      |   1998 | 2720683806.18336
 IRAQ                      |   1997 | 4652004437.06064
 IRAQ                      |   1996 | 4656050532.61942
 IRAQ                      |   1995 | 4660108239.78229
 IRAQ                      |   1994 | 4665870134.91127
 IRAQ                      |   1993 | 4649741427.71341
 IRAQ                      |   1992 | 4673658570.50725
 JAPAN                     |   1998 | 2714881663.68209
 JAPAN                     |   1997 | 4657128582.27528
 JAPAN                     |   1996 | 4651588256.09202
 JAPAN                     |   1995 | 4654267793.82763
 JAPAN                     |   1994 | 4639517824.16142
 JAPAN                     |   1993 | 4636817148.07501
 JAPAN                     |   1992 | 4635490004.86382
 JORDAN                    |   1998 | 2729910465.67857
 JORDAN                    |   1997 |  4646508613.7531
 JORDAN                    |   1996 | 4660818114.32208
 JORDAN                    |   1995 | 4648041189.91796
 JORDAN                    |   1994 | 4649006415.61683
 JORDAN                    |   1993 | 4651872678.46959
 JORDAN                    |   1992 | 4669023664.30929
 KENYA                     |   1998 | 2727630648.75053
 KENYA                     |   1997 | 4589578873.57964
 KENYA                     |   1996 | 4629016392.55248
 KENYA                     |   1995 | 4620400190.89197
 KENYA                     |   1994 | 4617716987.23461
 KENYA                     |   1993 | 4593861709.43522
 KENYA                     |   1992 | 4592351467.50096
 MOROCCO                   |   1998 | 2738454008.72646
 MOROCCO                   |   1997 | 4698293561.88652
 MOROCCO                   |   1996 | 4707951991.90422
 MOROCCO                   |   1995 | 4689517503.80587
 MOROCCO                   |   1994 |  4677291209.7832
 MOROCCO                   |   1993 | 4672811314.12798
 MOROCCO                   |   1992 | 4707669301.26019
 MOZAMBIQUE                |   1998 | 2736461392.83284
 MOZAMBIQUE                |   1997 | 4672426686.24014
 MOZAMBIQUE                |   1996 | 4730731528.87067
 MOZAMBIQUE                |   1995 | 4677491872.16433
 MOZAMBIQUE                |   1994 |  4676810385.2203
 MOZAMBIQUE                |   1993 | 4711981830.25606
 MOZAMBIQUE                |   1992 | 4698192924.52644
 PERU                      |   1998 | 2727673098.42556
 PERU                      |   1997 | 4654126948.25502
 PERU                      |   1996 | 4661777902.59228
 PERU                      |   1995 | 4624607398.86526
 PERU                      |   1994 | 4645767663.07049
 PERU                      |   1993 | 4656807747.02781
 PERU                      |   1992 | 4646791669.28687
 ROMANIA                   |   1998 | 2762673926.86326
 ROMANIA                   |   1997 | 4711378355.92132
 ROMANIA                   |   1996 | 4709013303.90656
 ROMANIA                   |   1995 | 4688678037.17675
 ROMANIA                   |   1994 | 4702852469.35296
 ROMANIA                   |   1993 | 4693657682.55895
 ROMANIA                   |   1992 | 4700362411.21321
 RUSSIA                    |   1998 | 2744618365.76501
 RUSSIA                    |   1997 | 4683644424.55926
 RUSSIA                    |   1996 | 4685062505.32088
 RUSSIA                    |   1995 | 4689695730.07858
 RUSSIA                    |   1994 | 4703494409.04478
 RUSSIA                    |   1993 | 4664914195.48641
 RUSSIA                    |   1992 | 4696680074.13334
 SAUDI ARABIA              |   1998 | 2751407053.89742
 SAUDI ARABIA              |   1997 | 4648447933.73995
 SAUDI ARABIA              |   1996 | 4671984841.53221
 SAUDI ARABIA              |   1995 | 4672739578.61327
 SAUDI ARABIA              |   1994 | 4654037826.05186
 SAUDI ARABIA              |   1993 | 4651348683.56049
 SAUDI ARABIA              |   1992 |  4661025021.2605
 UNITED KINGDOM            |   1998 |  2778161581.2591
 UNITED KINGDOM            |   1997 | 4704825690.10347
 UNITED KINGDOM            |   1996 | 4714224792.11829
 UNITED KINGDOM            |   1995 | 4721863574.07457
 UNITED KINGDOM            |   1994 | 4736045984.57936
 UNITED KINGDOM            |   1993 |  4719700962.0341
 UNITED KINGDOM            |   1992 | 4766545729.31576
 UNITED STATES             |   1998 | 2740880574.78325
 UNITED STATES             |   1997 |   4640277807.901
 UNITED STATES             |   1996 | 4691937005.47855
 UNITED STATES             |   1995 | 4638387441.91009
 UNITED STATES             |   1994 | 4691068546.25621
 UNITED STATES             |   1993 | 4685404873.02257
 UNITED STATES             |   1992 | 4681020033.63027
 VIETNAM                   |   1998 | 2731321953.18742
 VIETNAM                   |   1997 |  4691634276.4459
 VIETNAM                   |   1996 | 4702079879.06474
 VIETNAM                   |   1995 | 4717327991.06105
 VIETNAM                   |   1994 | 4689412485.95557
 VIETNAM                   |   1993 | 4670845654.76789
 VIETNAM                   |   1992 | 4706118393.90702
(175 rows)

COMMIT;
COMMIT
