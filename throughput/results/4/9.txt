BEGIN;
BEGIN
select
	nation,
	o_year,
	sum(amount) as sum_profit
from
	(
		select
			n_name as nation,
			extract(year from o_orderdate) as o_year,
			l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount
		from
			part,
			supplier,
			lineitem,
			partsupp,
			orders,
			nation
		where
			s_suppkey = l_suppkey
			and ps_suppkey = l_suppkey
			and ps_partkey = l_partkey
			and p_partkey = l_partkey
			and o_orderkey = l_orderkey
			and s_nationkey = n_nationkey
			and p_name like '%salmon%'
	) as profit
group by
	nation,
	o_year
order by
	nation,
	o_year desc;
          nation           | o_year |    sum_profit    
---------------------------+--------+------------------
 ALGERIA                   |   1998 | 2727233820.26931
 ALGERIA                   |   1997 | 4636022652.72503
 ALGERIA                   |   1996 | 4650455643.89712
 ALGERIA                   |   1995 | 4641602889.66131
 ALGERIA                   |   1994 | 4632831675.36293
 ALGERIA                   |   1993 | 4632292950.47751
 ALGERIA                   |   1992 | 4670910112.57302
 ARGENTINA                 |   1998 | 2728557249.92596
 ARGENTINA                 |   1997 | 4636566481.05967
 ARGENTINA                 |   1996 |  4673240472.3254
 ARGENTINA                 |   1995 |  4651190115.6249
 ARGENTINA                 |   1994 | 4633327343.06143
 ARGENTINA                 |   1993 | 4648505954.13758
 ARGENTINA                 |   1992 | 4670197696.30911
 BRAZIL                    |   1998 | 2731975304.16923
 BRAZIL                    |   1997 | 4673194641.88903
 BRAZIL                    |   1996 | 4662997466.83549
 BRAZIL                    |   1995 |  4646871865.4003
 BRAZIL                    |   1994 | 4663196878.85208
 BRAZIL                    |   1993 | 4655332858.41311
 BRAZIL                    |   1992 | 4678982708.91522
 CANADA                    |   1998 | 2762290870.62338
 CANADA                    |   1997 | 4686131275.62238
 CANADA                    |   1996 | 4676219880.33942
 CANADA                    |   1995 | 4704529800.08086
 CANADA                    |   1994 | 4664091986.76489
 CANADA                    |   1993 | 4677945963.21831
 CANADA                    |   1992 | 4699972155.68276
 CHINA                     |   1998 | 2742186538.86843
 CHINA                     |   1997 | 4671507117.29196
 CHINA                     |   1996 | 4710718400.29177
 CHINA                     |   1995 | 4654278464.11949
 CHINA                     |   1994 | 4680625767.24483
 CHINA                     |   1993 | 4659971743.88229
 CHINA                     |   1992 | 4708116010.98061
 EGYPT                     |   1998 | 2723390859.70577
 EGYPT                     |   1997 | 4627927121.09518
 EGYPT                     |   1996 | 4628283328.17687
 EGYPT                     |   1995 | 4655564256.46328
 EGYPT                     |   1994 | 4652091575.29815
 EGYPT                     |   1993 | 4655827430.00105
 EGYPT                     |   1992 | 4660496502.99905
 ETHIOPIA                  |   1998 | 2738414933.00162
 ETHIOPIA                  |   1997 | 4658302142.41305
 ETHIOPIA                  |   1996 | 4696589253.67978
 ETHIOPIA                  |   1995 | 4653480178.50686
 ETHIOPIA                  |   1994 | 4656973950.42178
 ETHIOPIA                  |   1993 | 4677737446.00273
 ETHIOPIA                  |   1992 | 4669856945.52387
 FRANCE                    |   1998 | 2762047260.13694
 FRANCE                    |   1997 | 4688733665.26548
 FRANCE                    |   1996 | 4722999770.01148
 FRANCE                    |   1995 | 4694578788.32954
 FRANCE                    |   1994 | 4687489849.18532
 FRANCE                    |   1993 | 4698246932.58389
 FRANCE                    |   1992 | 4713108352.47662
 GERMANY                   |   1998 | 2764129117.44774
 GERMANY                   |   1997 | 4694981469.44077
 GERMANY                   |   1996 | 4706621163.77255
 GERMANY                   |   1995 | 4692443610.69591
 GERMANY                   |   1994 | 4682908023.63476
 GERMANY                   |   1993 |   4687375844.831
 GERMANY                   |   1992 |  4705310988.7157
 INDIA                     |   1998 | 2723955630.88273
 INDIA                     |   1997 | 4656792266.26688
 INDIA                     |   1996 | 4651213465.26137
 INDIA                     |   1995 | 4656543438.13457
 INDIA                     |   1994 | 4670268273.29066
 INDIA                     |   1993 | 4658773091.84045
 INDIA                     |   1992 | 4649842316.12758
 INDONESIA                 |   1998 | 2718320161.57429
 INDONESIA                 |   1997 | 4651478509.13788
 INDONESIA                 |   1996 | 4618160843.19474
 INDONESIA                 |   1995 | 4641263870.14582
 INDONESIA                 |   1994 | 4640280102.35557
 INDONESIA                 |   1993 | 4639656547.68428
 INDONESIA                 |   1992 |  4654413904.0912
 IRAN                      |   1998 | 2739099164.16602
 IRAN                      |   1997 | 4662521873.90878
 IRAN                      |   1996 | 4644165145.23043
 IRAN                      |   1995 | 4651083827.16407
 IRAN                      |   1994 | 4660522704.75206
 IRAN                      |   1993 | 4646194699.27629
 IRAN                      |   1992 | 4643613575.32937
 IRAQ                      |   1998 | 2727256276.70365
 IRAQ                      |   1997 | 4672438451.60514
 IRAQ                      |   1996 | 4652816128.03121
 IRAQ                      |   1995 |  4630251801.3613
 IRAQ                      |   1994 |  4644317008.1953
 IRAQ                      |   1993 | 4651388206.32091
 IRAQ                      |   1992 | 4666669551.87773
 JAPAN                     |   1998 | 2733736606.89804
 JAPAN                     |   1997 | 4646445177.54543
 JAPAN                     |   1996 | 4655511111.81036
 JAPAN                     |   1995 | 4658261612.41539
 JAPAN                     |   1994 | 4618301396.40467
 JAPAN                     |   1993 | 4636189090.19139
 JAPAN                     |   1992 | 4643228484.63376
 JORDAN                    |   1998 |  2743070390.8184
 JORDAN                    |   1997 |   4655068401.845
 JORDAN                    |   1996 | 4656345742.66542
 JORDAN                    |   1995 | 4631828740.23419
 JORDAN                    |   1994 | 4653309060.37407
 JORDAN                    |   1993 | 4648530965.21671
 JORDAN                    |   1992 | 4650704973.84227
 KENYA                     |   1998 | 2711845844.51583
 KENYA                     |   1997 | 4622121484.66239
 KENYA                     |   1996 | 4644855736.02752
 KENYA                     |   1995 |  4610678272.1185
 KENYA                     |   1994 | 4626599213.37435
 KENYA                     |   1993 | 4611192750.80767
 KENYA                     |   1992 | 4651324616.60651
 MOROCCO                   |   1998 | 2731723855.74966
 MOROCCO                   |   1997 | 4672326016.97924
 MOROCCO                   |   1996 | 4706516884.74455
 MOROCCO                   |   1995 | 4679550355.49053
 MOROCCO                   |   1994 | 4668324975.91004
 MOROCCO                   |   1993 |   4687590037.183
 MOROCCO                   |   1992 | 4693319886.78187
 MOZAMBIQUE                |   1998 | 2724062819.91484
 MOZAMBIQUE                |   1997 | 4666388470.48625
 MOZAMBIQUE                |   1996 | 4688566564.83962
 MOZAMBIQUE                |   1995 | 4662122291.46992
 MOZAMBIQUE                |   1994 | 4664642068.40162
 MOZAMBIQUE                |   1993 | 4664343423.73993
 MOZAMBIQUE                |   1992 | 4671635972.54658
 PERU                      |   1998 | 2717231465.95908
 PERU                      |   1997 | 4644856585.24068
 PERU                      |   1996 | 4658975953.43784
 PERU                      |   1995 | 4638574980.89365
 PERU                      |   1994 | 4651679855.86862
 PERU                      |   1993 | 4631745380.64736
 PERU                      |   1992 | 4648297079.54294
 ROMANIA                   |   1998 | 2734268996.61768
 ROMANIA                   |   1997 | 4671753175.56671
 ROMANIA                   |   1996 | 4675914624.92692
 ROMANIA                   |   1995 | 4657608554.12693
 ROMANIA                   |   1994 | 4688126417.44725
 ROMANIA                   |   1993 | 4684847248.27741
 ROMANIA                   |   1992 | 4680783050.72673
 RUSSIA                    |   1998 | 2728846270.52739
 RUSSIA                    |   1997 | 4664633934.04338
 RUSSIA                    |   1996 | 4646455460.26953
 RUSSIA                    |   1995 | 4655106179.79142
 RUSSIA                    |   1994 | 4659118698.30134
 RUSSIA                    |   1993 | 4635086995.31431
 RUSSIA                    |   1992 | 4670074644.47973
 SAUDI ARABIA              |   1998 |  2724110592.5216
 SAUDI ARABIA              |   1997 |  4655215697.8737
 SAUDI ARABIA              |   1996 | 4649021512.98062
 SAUDI ARABIA              |   1995 | 4651333120.46474
 SAUDI ARABIA              |   1994 | 4666172696.85241
 SAUDI ARABIA              |   1993 | 4640516080.30752
 SAUDI ARABIA              |   1992 | 4653681286.96631
 UNITED KINGDOM            |   1998 | 2773240081.53429
 UNITED KINGDOM            |   1997 | 4711432980.07822
 UNITED KINGDOM            |   1996 |  4699028581.3082
 UNITED KINGDOM            |   1995 | 4694514162.86065
 UNITED KINGDOM            |   1994 | 4713623529.52247
 UNITED KINGDOM            |   1993 | 4695880602.66702
 UNITED KINGDOM            |   1992 | 4737368329.02754
 UNITED STATES             |   1998 | 2731155199.81735
 UNITED STATES             |   1997 | 4678139166.02488
 UNITED STATES             |   1996 | 4676687791.78431
 UNITED STATES             |   1995 | 4677055102.62447
 UNITED STATES             |   1994 | 4673257580.83869
 UNITED STATES             |   1993 | 4654926680.02167
 UNITED STATES             |   1992 | 4672666966.91215
 VIETNAM                   |   1998 |  2740368510.8313
 VIETNAM                   |   1997 | 4645727081.53146
 VIETNAM                   |   1996 | 4700216459.73922
 VIETNAM                   |   1995 | 4712219428.35537
 VIETNAM                   |   1994 | 4680472413.64884
 VIETNAM                   |   1993 | 4675751141.40939
 VIETNAM                   |   1992 | 4679025214.53197
(175 rows)

COMMIT;
COMMIT
