BEGIN;
BEGIN
select
	nation,
	o_year,
	sum(amount) as sum_profit
from
	(
		select
			n_name as nation,
			extract(year from o_orderdate) as o_year,
			l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount
		from
			part,
			supplier,
			lineitem,
			partsupp,
			orders,
			nation
		where
			s_suppkey = l_suppkey
			and ps_suppkey = l_suppkey
			and ps_partkey = l_partkey
			and p_partkey = l_partkey
			and o_orderkey = l_orderkey
			and s_nationkey = n_nationkey
			and p_name like '%spring%'
	) as profit
group by
	nation,
	o_year
order by
	nation,
	o_year desc;
          nation           | o_year |    sum_profit    
---------------------------+--------+------------------
 ALGERIA                   |   1998 | 2723227990.77805
 ALGERIA                   |   1997 | 4673336595.61916
 ALGERIA                   |   1996 | 4664344100.85702
 ALGERIA                   |   1995 | 4642433764.27924
 ALGERIA                   |   1994 |    4658435591.21
 ALGERIA                   |   1993 | 4648949555.84923
 ALGERIA                   |   1992 | 4672331504.58907
 ARGENTINA                 |   1998 | 2733734937.80869
 ARGENTINA                 |   1997 | 4632419408.06558
 ARGENTINA                 |   1996 | 4656939622.96883
 ARGENTINA                 |   1995 | 4661142701.43909
 ARGENTINA                 |   1994 | 4646435065.34117
 ARGENTINA                 |   1993 | 4634501022.81113
 ARGENTINA                 |   1992 | 4669377789.01351
 BRAZIL                    |   1998 | 2745447936.98245
 BRAZIL                    |   1997 | 4674628007.21027
 BRAZIL                    |   1996 | 4664385953.32062
 BRAZIL                    |   1995 | 4670836671.57821
 BRAZIL                    |   1994 | 4645016965.18052
 BRAZIL                    |   1993 | 4668938955.26796
 BRAZIL                    |   1992 | 4678382945.77393
 CANADA                    |   1998 | 2744144661.95241
 CANADA                    |   1997 | 4682336036.91075
 CANADA                    |   1996 | 4686009631.60296
 CANADA                    |   1995 | 4679716122.55361
 CANADA                    |   1994 | 4656250185.29782
 CANADA                    |   1993 | 4663123429.06562
 CANADA                    |   1992 | 4689361520.98232
 CHINA                     |   1998 | 2732388230.57332
 CHINA                     |   1997 | 4648480322.45307
 CHINA                     |   1996 | 4676009958.61181
 CHINA                     |   1995 | 4681207104.37371
 CHINA                     |   1994 | 4656238181.97698
 CHINA                     |   1993 | 4657155245.85764
 CHINA                     |   1992 | 4678222064.96158
 EGYPT                     |   1998 | 2726246219.60682
 EGYPT                     |   1997 | 4654535232.36809
 EGYPT                     |   1996 | 4660604613.40746
 EGYPT                     |   1995 | 4657964912.31957
 EGYPT                     |   1994 | 4636461042.42932
 EGYPT                     |   1993 | 4665365607.99137
 EGYPT                     |   1992 |  4654723104.7949
 ETHIOPIA                  |   1998 | 2778839404.26564
 ETHIOPIA                  |   1997 | 4713521287.11436
 ETHIOPIA                  |   1996 | 4726872239.28288
 ETHIOPIA                  |   1995 | 4694366439.75962
 ETHIOPIA                  |   1994 | 4712254289.42052
 ETHIOPIA                  |   1993 | 4694718554.74098
 ETHIOPIA                  |   1992 | 4715709993.23431
 FRANCE                    |   1998 | 2747741693.31759
 FRANCE                    |   1997 | 4694161797.07291
 FRANCE                    |   1996 | 4727576902.90794
 FRANCE                    |   1995 | 4685689198.00321
 FRANCE                    |   1994 | 4681657186.62198
 FRANCE                    |   1993 | 4689499188.14329
 FRANCE                    |   1992 | 4710480188.32911
 GERMANY                   |   1998 | 2745618777.23288
 GERMANY                   |   1997 | 4685991052.22466
 GERMANY                   |   1996 | 4711187241.94462
 GERMANY                   |   1995 | 4695588157.68938
 GERMANY                   |   1994 | 4684221505.70864
 GERMANY                   |   1993 | 4686042603.33212
 GERMANY                   |   1992 | 4728492724.77809
 INDIA                     |   1998 | 2741520483.55146
 INDIA                     |   1997 | 4659491094.20303
 INDIA                     |   1996 | 4663495820.74666
 INDIA                     |   1995 | 4649165855.71219
 INDIA                     |   1994 | 4683494182.69579
 INDIA                     |   1993 | 4655959971.24581
 INDIA                     |   1992 | 4675178942.39085
 INDONESIA                 |   1998 | 2704455691.10918
 INDONESIA                 |   1997 | 4633111243.24689
 INDONESIA                 |   1996 | 4643550066.49148
 INDONESIA                 |   1995 | 4628879367.84756
 INDONESIA                 |   1994 | 4638844500.78956
 INDONESIA                 |   1993 |  4634390425.3814
 INDONESIA                 |   1992 | 4642528128.81199
 IRAN                      |   1998 | 2730377648.68333
 IRAN                      |   1997 | 4648294388.38166
 IRAN                      |   1996 | 4652874070.60379
 IRAN                      |   1995 | 4659196106.21017
 IRAN                      |   1994 | 4627348554.31228
 IRAN                      |   1993 | 4646704618.91421
 IRAN                      |   1992 | 4631726186.16516
 IRAQ                      |   1998 | 2701526040.85011
 IRAQ                      |   1997 | 4617393465.05562
 IRAQ                      |   1996 | 4632961634.46894
 IRAQ                      |   1995 | 4608656515.99135
 IRAQ                      |   1994 | 4627453071.56541
 IRAQ                      |   1993 | 4622938786.97099
 IRAQ                      |   1992 | 4637833745.88428
 JAPAN                     |   1998 | 2711650056.65646
 JAPAN                     |   1997 | 4615785432.20562
 JAPAN                     |   1996 | 4636346179.55075
 JAPAN                     |   1995 |  4652121535.6671
 JAPAN                     |   1994 |  4631500702.3284
 JAPAN                     |   1993 | 4627987493.99994
 JAPAN                     |   1992 | 4626430617.15933
 JORDAN                    |   1998 | 2727516406.18159
 JORDAN                    |   1997 | 4660874459.17645
 JORDAN                    |   1996 | 4665985087.20825
 JORDAN                    |   1995 | 4674364331.57255
 JORDAN                    |   1994 | 4673356522.95475
 JORDAN                    |   1993 | 4659911219.79248
 JORDAN                    |   1992 | 4666253048.68492
 KENYA                     |   1998 | 2728763484.07684
 KENYA                     |   1997 | 4655464176.50629
 KENYA                     |   1996 | 4631527194.06312
 KENYA                     |   1995 | 4641458915.96944
 KENYA                     |   1994 | 4617070224.64142
 KENYA                     |   1993 |   4627956604.005
 KENYA                     |   1992 | 4634431678.95911
 MOROCCO                   |   1998 | 2748306860.31946
 MOROCCO                   |   1997 | 4694406634.13885
 MOROCCO                   |   1996 | 4690158967.73337
 MOROCCO                   |   1995 | 4695864844.36092
 MOROCCO                   |   1994 | 4682527319.19838
 MOROCCO                   |   1993 | 4687472112.01136
 MOROCCO                   |   1992 |  4705580101.6575
 MOZAMBIQUE                |   1998 | 2717060354.29525
 MOZAMBIQUE                |   1997 | 4631962072.45874
 MOZAMBIQUE                |   1996 | 4651069836.21188
 MOZAMBIQUE                |   1995 | 4621130257.11317
 MOZAMBIQUE                |   1994 | 4631507037.87721
 MOZAMBIQUE                |   1993 |  4624865406.0965
 MOZAMBIQUE                |   1992 | 4666324747.43017
 PERU                      |   1998 | 2722692347.47616
 PERU                      |   1997 | 4616720802.33747
 PERU                      |   1996 | 4641942799.29962
 PERU                      |   1995 | 4642159366.13202
 PERU                      |   1994 | 4619631721.37697
 PERU                      |   1993 | 4598596885.88773
 PERU                      |   1992 | 4630750662.66299
 ROMANIA                   |   1998 |  2750616743.1275
 ROMANIA                   |   1997 | 4670434574.31326
 ROMANIA                   |   1996 | 4688144542.89567
 ROMANIA                   |   1995 | 4693281878.56627
 ROMANIA                   |   1994 | 4696249450.67015
 ROMANIA                   |   1993 | 4690317602.09945
 ROMANIA                   |   1992 | 4701683012.86596
 RUSSIA                    |   1998 |  2727184061.4993
 RUSSIA                    |   1997 |  4664379291.4311
 RUSSIA                    |   1996 |  4685225635.8531
 RUSSIA                    |   1995 | 4661014031.67879
 RUSSIA                    |   1994 | 4675709232.96199
 RUSSIA                    |   1993 | 4674570471.97881
 RUSSIA                    |   1992 | 4678731525.18248
 SAUDI ARABIA              |   1998 | 2730180225.59726
 SAUDI ARABIA              |   1997 | 4682639769.30606
 SAUDI ARABIA              |   1996 | 4699088286.74004
 SAUDI ARABIA              |   1995 | 4692955136.32495
 SAUDI ARABIA              |   1994 | 4659063535.92239
 SAUDI ARABIA              |   1993 | 4674992619.67786
 SAUDI ARABIA              |   1992 | 4689101477.85772
 UNITED KINGDOM            |   1998 |  2755444219.7875
 UNITED KINGDOM            |   1997 | 4693444456.24129
 UNITED KINGDOM            |   1996 | 4695265895.00729
 UNITED KINGDOM            |   1995 | 4661585326.67269
 UNITED KINGDOM            |   1994 | 4690513666.75278
 UNITED KINGDOM            |   1993 | 4684833805.37666
 UNITED KINGDOM            |   1992 | 4700630432.70408
 UNITED STATES             |   1998 | 2754575468.14913
 UNITED STATES             |   1997 | 4676414663.41827
 UNITED STATES             |   1996 | 4711886449.77487
 UNITED STATES             |   1995 | 4677478823.98846
 UNITED STATES             |   1994 | 4695610797.54784
 UNITED STATES             |   1993 | 4680668074.74311
 UNITED STATES             |   1992 | 4668563273.47344
 VIETNAM                   |   1998 | 2745706201.75249
 VIETNAM                   |   1997 |  4685476684.2081
 VIETNAM                   |   1996 | 4704048522.94506
 VIETNAM                   |   1995 | 4686482792.22809
 VIETNAM                   |   1994 | 4670649277.41958
 VIETNAM                   |   1993 | 4692996768.74683
 VIETNAM                   |   1992 | 4680079908.98329
(175 rows)

COMMIT;
COMMIT
