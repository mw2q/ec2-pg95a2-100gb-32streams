BEGIN;
BEGIN
select
	nation,
	o_year,
	sum(amount) as sum_profit
from
	(
		select
			n_name as nation,
			extract(year from o_orderdate) as o_year,
			l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount
		from
			part,
			supplier,
			lineitem,
			partsupp,
			orders,
			nation
		where
			s_suppkey = l_suppkey
			and ps_suppkey = l_suppkey
			and ps_partkey = l_partkey
			and p_partkey = l_partkey
			and o_orderkey = l_orderkey
			and s_nationkey = n_nationkey
			and p_name like '%goldenrod%'
	) as profit
group by
	nation,
	o_year
order by
	nation,
	o_year desc;
          nation           | o_year |    sum_profit    
---------------------------+--------+------------------
 ALGERIA                   |   1998 | 2729649243.90239
 ALGERIA                   |   1997 | 4631818032.49153
 ALGERIA                   |   1996 | 4655566658.81333
 ALGERIA                   |   1995 | 4665219454.87067
 ALGERIA                   |   1994 | 4639733797.79303
 ALGERIA                   |   1993 | 4667948260.76352
 ALGERIA                   |   1992 | 4623535824.97434
 ARGENTINA                 |   1998 | 2728470846.73757
 ARGENTINA                 |   1997 | 4635058932.24411
 ARGENTINA                 |   1996 |  4663263123.5016
 ARGENTINA                 |   1995 | 4628986488.23305
 ARGENTINA                 |   1994 | 4645658544.98727
 ARGENTINA                 |   1993 | 4632303409.67945
 ARGENTINA                 |   1992 | 4632501577.56342
 BRAZIL                    |   1998 | 2762310866.02578
 BRAZIL                    |   1997 | 4661610711.72689
 BRAZIL                    |   1996 |    4679098295.45
 BRAZIL                    |   1995 | 4662057263.83188
 BRAZIL                    |   1994 |  4663067850.0127
 BRAZIL                    |   1993 | 4679483461.13014
 BRAZIL                    |   1992 |  4650010082.7589
 CANADA                    |   1998 |  2741652027.5392
 CANADA                    |   1997 | 4651532139.28224
 CANADA                    |   1996 | 4670484378.14961
 CANADA                    |   1995 |  4645563570.3373
 CANADA                    |   1994 | 4643034318.88591
 CANADA                    |   1993 | 4662801834.33925
 CANADA                    |   1992 | 4677313684.27088
 CHINA                     |   1998 | 2752680073.66338
 CHINA                     |   1997 | 4673503637.22352
 CHINA                     |   1996 | 4699637616.51571
 CHINA                     |   1995 | 4661859364.55342
 CHINA                     |   1994 | 4666424987.68411
 CHINA                     |   1993 | 4653012016.21896
 CHINA                     |   1992 | 4695282580.86901
 EGYPT                     |   1998 | 2732493877.38923
 EGYPT                     |   1997 | 4648037113.00002
 EGYPT                     |   1996 | 4688179267.54146
 EGYPT                     |   1995 | 4677552677.88848
 EGYPT                     |   1994 | 4661572919.00138
 EGYPT                     |   1993 | 4677212830.53134
 EGYPT                     |   1992 | 4676439313.16958
 ETHIOPIA                  |   1998 | 2741821458.73691
 ETHIOPIA                  |   1997 | 4711968680.11183
 ETHIOPIA                  |   1996 | 4720944998.09292
 ETHIOPIA                  |   1995 | 4727092824.78428
 ETHIOPIA                  |   1994 |  4710297771.5371
 ETHIOPIA                  |   1993 | 4692813762.84986
 ETHIOPIA                  |   1992 | 4727294867.22492
 FRANCE                    |   1998 | 2758619899.93868
 FRANCE                    |   1997 | 4710194821.47247
 FRANCE                    |   1996 | 4724329632.80668
 FRANCE                    |   1995 |  4694258964.6797
 FRANCE                    |   1994 | 4723352677.22372
 FRANCE                    |   1993 | 4726118899.79312
 FRANCE                    |   1992 |  4719407717.2765
 GERMANY                   |   1998 | 2764557967.01668
 GERMANY                   |   1997 | 4674778623.53027
 GERMANY                   |   1996 | 4698854123.61354
 GERMANY                   |   1995 | 4656110761.53092
 GERMANY                   |   1994 | 4678464637.11286
 GERMANY                   |   1993 | 4705446540.01001
 GERMANY                   |   1992 | 4709700187.61913
 INDIA                     |   1998 | 2733373968.86209
 INDIA                     |   1997 | 4648634246.38082
 INDIA                     |   1996 | 4672041985.04407
 INDIA                     |   1995 | 4666788615.57751
 INDIA                     |   1994 | 4652740062.37727
 INDIA                     |   1993 |  4657260180.8082
 INDIA                     |   1992 | 4662562510.29038
 INDONESIA                 |   1998 | 2737146762.16523
 INDONESIA                 |   1997 | 4637213851.93318
 INDONESIA                 |   1996 | 4638339278.79518
 INDONESIA                 |   1995 | 4613115795.83204
 INDONESIA                 |   1994 | 4647201547.56489
 INDONESIA                 |   1993 | 4625453248.73911
 INDONESIA                 |   1992 | 4639607374.26864
 IRAN                      |   1998 | 2726660027.00971
 IRAN                      |   1997 | 4633209567.80227
 IRAN                      |   1996 |  4641444476.9093
 IRAN                      |   1995 | 4623882341.95805
 IRAN                      |   1994 | 4643197765.61855
 IRAN                      |   1993 | 4641178222.42935
 IRAN                      |   1992 | 4666980421.73208
 IRAQ                      |   1998 | 2712561233.33155
 IRAQ                      |   1997 | 4659627671.81669
 IRAQ                      |   1996 | 4658059880.34968
 IRAQ                      |   1995 | 4651685800.51664
 IRAQ                      |   1994 | 4639017554.24095
 IRAQ                      |   1993 | 4670469174.03286
 IRAQ                      |   1992 | 4662394655.90683
 JAPAN                     |   1998 | 2711888209.15506
 JAPAN                     |   1997 | 4642374093.69382
 JAPAN                     |   1996 | 4685554690.15426
 JAPAN                     |   1995 | 4668862831.52668
 JAPAN                     |   1994 | 4669649569.59744
 JAPAN                     |   1993 | 4643725744.73511
 JAPAN                     |   1992 | 4653847705.12074
 JORDAN                    |   1998 |  2731676210.2872
 JORDAN                    |   1997 | 4656330099.12931
 JORDAN                    |   1996 | 4677126352.00436
 JORDAN                    |   1995 | 4647856574.52523
 JORDAN                    |   1994 | 4666407696.64478
 JORDAN                    |   1993 | 4622957551.40283
 JORDAN                    |   1992 | 4652974136.10511
 KENYA                     |   1998 | 2745880785.74072
 KENYA                     |   1997 | 4639300801.90914
 KENYA                     |   1996 | 4670569431.61069
 KENYA                     |   1995 | 4674420537.63703
 KENYA                     |   1994 | 4644131843.95517
 KENYA                     |   1993 | 4652870538.30562
 KENYA                     |   1992 | 4663573770.76092
 MOROCCO                   |   1998 | 2734510606.03293
 MOROCCO                   |   1997 | 4689478562.42158
 MOROCCO                   |   1996 | 4701174717.57135
 MOROCCO                   |   1995 | 4694217266.45618
 MOROCCO                   |   1994 | 4648464850.83501
 MOROCCO                   |   1993 | 4664496025.68469
 MOROCCO                   |   1992 | 4660512487.00273
 MOZAMBIQUE                |   1998 | 2740431448.90534
 MOZAMBIQUE                |   1997 | 4653389312.31775
 MOZAMBIQUE                |   1996 | 4697547726.72271
 MOZAMBIQUE                |   1995 | 4657357226.66144
 MOZAMBIQUE                |   1994 | 4664580581.88333
 MOZAMBIQUE                |   1993 | 4656862533.99971
 MOZAMBIQUE                |   1992 | 4693797233.93637
 PERU                      |   1998 | 2697401623.17388
 PERU                      |   1997 | 4613687066.98123
 PERU                      |   1996 |  4630855875.4111
 PERU                      |   1995 | 4635905567.02316
 PERU                      |   1994 | 4622534764.66935
 PERU                      |   1993 | 4613077746.84155
 PERU                      |   1992 | 4640585784.39173
 ROMANIA                   |   1998 | 2749246407.25525
 ROMANIA                   |   1997 | 4697380278.94367
 ROMANIA                   |   1996 | 4668776573.92272
 ROMANIA                   |   1995 | 4690752606.00406
 ROMANIA                   |   1994 | 4687664142.01736
 ROMANIA                   |   1993 | 4666786348.87466
 ROMANIA                   |   1992 | 4699691128.66135
 RUSSIA                    |   1998 | 2723346291.62439
 RUSSIA                    |   1997 | 4697699119.46794
 RUSSIA                    |   1996 | 4656017035.20819
 RUSSIA                    |   1995 | 4657196532.50626
 RUSSIA                    |   1994 | 4658193237.78371
 RUSSIA                    |   1993 | 4675876594.80382
 RUSSIA                    |   1992 | 4687561792.59748
 SAUDI ARABIA              |   1998 |  2718274453.3214
 SAUDI ARABIA              |   1997 | 4635822015.32828
 SAUDI ARABIA              |   1996 | 4701107833.04579
 SAUDI ARABIA              |   1995 | 4664161517.98472
 SAUDI ARABIA              |   1994 | 4676286895.43211
 SAUDI ARABIA              |   1993 |  4661769201.3954
 SAUDI ARABIA              |   1992 | 4672670424.03407
 UNITED KINGDOM            |   1998 | 2749252925.55007
 UNITED KINGDOM            |   1997 | 4691212122.97545
 UNITED KINGDOM            |   1996 | 4696260884.42001
 UNITED KINGDOM            |   1995 |  4657686851.2677
 UNITED KINGDOM            |   1994 | 4697520355.48386
 UNITED KINGDOM            |   1993 | 4697114189.53702
 UNITED KINGDOM            |   1992 | 4708010641.16182
 UNITED STATES             |   1998 | 2763589710.89446
 UNITED STATES             |   1997 |  4691349711.2162
 UNITED STATES             |   1996 | 4715640403.21688
 UNITED STATES             |   1995 | 4652222178.81926
 UNITED STATES             |   1994 | 4671986957.84668
 UNITED STATES             |   1993 | 4692241448.94014
 UNITED STATES             |   1992 | 4717537638.90484
 VIETNAM                   |   1998 | 2747321505.00715
 VIETNAM                   |   1997 | 4687322217.83731
 VIETNAM                   |   1996 | 4681772282.57975
 VIETNAM                   |   1995 | 4678032469.12885
 VIETNAM                   |   1994 | 4702008323.55531
 VIETNAM                   |   1993 | 4683484626.41426
 VIETNAM                   |   1992 | 4689605045.24937
(175 rows)

COMMIT;
COMMIT
